import { Meta, Story, Canvas, ArgsTable, Description } from '@storybook/addon-docs';
import { TopNav } from './top-nav';
import { useLayoutStore } from '@/stores/ui/layout-store';

<Meta
  title="Layout Components/TopNav"
  component={TopNav}
  decorators={[
    (Story) => (
      <div className="min-h-[300px] bg-background">
        <Story />
        <div className="p-8">
          <div className="text-muted-foreground text-sm">
            Main content area - TopNav appears above this content
          </div>
        </div>
      </div>
    ),
  ]}
  parameters={{
    docs: {
      description: {
        component: `
The TopNav component is the main navigation header that provides comprehensive navigation functionality.
It intelligently adapts to different screen sizes and authentication states.

## Features

- Logo/brand section with home link
- Global navigation menu (desktop and tablet)
- Integrated search functionality
- Theme toggle for light/dark/system themes
- User authentication menu
- Mobile-responsive design with hamburger menu
- Multiple visual variants (default, minimal, transparent)
- Flexible positioning (sticky, fixed, static)
- Backdrop blur effects for modern appearance
- Full accessibility support with proper ARIA labels
- TypeScript support with strict typing

## Usage

Use TopNav for:
- Main application header navigation
- Primary navigation across all pages
- Responsive navigation that adapts to any screen size
- Authentication-aware navigation experiences
- Modern, glassmorphism-style navigation bars
- Accessible navigation with screen reader support
        `
      }
    }
  }}
  argTypes={{
    variant: {
      control: { type: 'select' },
      options: ['default', 'minimal', 'transparent'],
      description: 'Visual variant of the navigation bar',
      defaultValue: 'default'
    },
    position: {
      control: { type: 'select' },
      options: ['sticky', 'fixed', 'static'],
      description: 'CSS positioning behavior',
      defaultValue: 'sticky'
    },
    className: {
      control: { type: 'text' },
      description: 'Additional CSS classes to apply'
    }
  }}
/>

# TopNav

<Description of={TopNav} />

## Default Navigation

<Canvas>
  <Story name="Default">
    {() => (
      <div className="relative">
        <TopNav position="static" />
        <div className="p-6 bg-muted/20">
          <div className="text-sm text-muted-foreground">
            Page content appears below the navigation bar
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Visual Variants

<Canvas>
  <Story name="Visual Variants">
    {() => (
      <div className="space-y-8">
        <div>
          <div className="text-sm text-muted-foreground mb-2">Default variant:</div>
          <TopNav variant="default" position="static" />
        </div>

        <div>
          <div className="text-sm text-muted-foreground mb-2">Minimal variant:</div>
          <TopNav variant="minimal" position="static" />
        </div>

        <div className="bg-gradient-to-r from-blue-500 to-purple-600 p-1 rounded">
          <div className="text-sm text-white mb-2 px-3 py-1">Transparent variant (on colored background):</div>
          <TopNav variant="transparent" position="static" />
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Position Variants

<Canvas>
  <Story name="Position Variants">
    {() => (
      <div className="space-y-8">
        <div>
          <div className="text-sm text-muted-foreground mb-2">Static positioning:</div>
          <div className="border rounded-lg overflow-hidden">
            <TopNav variant="default" position="static" />
            <div className="p-6 bg-muted/10">
              <div className="text-sm">Content flows normally after navigation</div>
            </div>
          </div>
        </div>

        <div>
          <div className="text-sm text-muted-foreground mb-2">Sticky positioning (scrolls with page):</div>
          <div className="border rounded-lg overflow-hidden h-48 overflow-y-auto">
            <TopNav variant="default" position="sticky" />
            <div className="p-6 space-y-4 bg-muted/10">
              <div className="text-sm">Scroll this content to see sticky behavior</div>
              {Array.from({ length: 10 }).map((_, i) => (
                <div key={i} className="text-xs text-muted-foreground">
                  Content line {i + 1} - navigation sticks to top when scrolling
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Responsive Breakpoints

<Canvas>
  <Story name="Responsive Breakpoints">
    {() => (
      <div className="space-y-6">
        <div className="text-sm text-muted-foreground">
          Navigation adapts to different screen sizes:
        </div>

        <div className="space-y-4">
          <div>
            <div className="text-xs text-muted-foreground mb-2">Desktop (> 1024px) - Full navigation:</div>
            <div className="border rounded-lg overflow-hidden">
              <TopNav position="static" />
            </div>
          </div>

          <div>
            <div className="text-xs text-muted-foreground mb-2">Tablet (768px - 1024px) - Compact navigation:</div>
            <div className="max-w-2xl border rounded-lg overflow-hidden">
              <TopNav position="static" />
            </div>
          </div>

          <div>
            <div className="text-xs text-muted-foreground mb-2">Mobile (< 768px) - Minimal with hamburger menu:</div>
            <div className="max-w-sm border rounded-lg overflow-hidden">
              <TopNav position="static" />
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Authentication States

<Canvas>
  <Story name="Authentication States">
    {() => (
      <div className="space-y-6">
        <div className="text-sm text-muted-foreground">
          Navigation adapts based on user authentication:
        </div>

        <div className="space-y-4">
          <div>
            <div className="text-xs text-muted-foreground mb-2">Unauthenticated user:</div>
            <div className="border rounded-lg overflow-hidden">
              <TopNav position="static" />
            </div>
          </div>

          <div>
            <div className="text-xs text-muted-foreground mb-2">Authenticated user:</div>
            <div className="border rounded-lg overflow-hidden">
              <TopNav position="static" />
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Full Page Layout Context

<Canvas>
  <Story name="Full Page Layout">
    {() => (
      <div className="min-h-screen flex flex-col">
        <TopNav position="static" />

        {/* Main content */}
        <main className="flex-1 bg-gradient-to-br from-background to-muted/20">
          <div className="container mx-auto px-6 py-12">
            <div className="space-y-8">
              <div>
                <h1 className="text-4xl font-bold tracking-tight">Welcome to Recipe App</h1>
                <p className="text-xl text-muted-foreground mt-2">
                  Discover, create, and share amazing recipes
                </p>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {Array.from({ length: 6 }).map((_, i) => (
                  <div key={i} className="bg-background rounded-lg p-6 shadow-sm border">
                    <div className="h-32 bg-muted rounded mb-4" />
                    <h3 className="font-semibold mb-2">Recipe Card {i + 1}</h3>
                    <p className="text-sm text-muted-foreground">
                      Sample recipe description for demonstration
                    </p>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </main>
      </div>
    )}
  </Story>
</Canvas>

## With Scrollable Content

<Canvas>
  <Story name="Scrollable Content">
    {() => (
      <div className="h-96 border rounded-lg overflow-hidden">
        <TopNav position="sticky" />
        <div className="p-6 space-y-4">
          <h2 className="text-xl font-semibold">Scrollable Content</h2>
          <p className="text-muted-foreground">
            Scroll down to see the sticky navigation behavior
          </p>

          {Array.from({ length: 20 }).map((_, i) => (
            <div key={i} className="p-4 bg-muted/10 rounded">
              <h3 className="font-medium">Content Section {i + 1}</h3>
              <p className="text-sm text-muted-foreground">
                This is sample content to demonstrate scrolling behavior.
                The navigation bar will stick to the top when scrolling.
              </p>
            </div>
          ))}
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Landing Page Style

<Canvas>
  <Story name="Landing Page">
    {() => (
      <div className="min-h-[500px] relative">
        {/* Hero background */}
        <div className="absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-secondary/10" />

        {/* Navigation */}
        <TopNav variant="transparent" position="static" />

        {/* Hero content */}
        <div className="relative container mx-auto px-6 py-16">
          <div className="text-center space-y-6">
            <h1 className="text-5xl font-bold tracking-tight">
              Cook Amazing Meals
            </h1>
            <p className="text-xl text-muted-foreground max-w-2xl mx-auto">
              Discover thousands of recipes, create meal plans, and organize your cooking journey
            </p>
            <div className="flex items-center justify-center gap-4">
              <button className="bg-primary text-primary-foreground px-6 py-3 rounded-lg font-medium">
                Get Started
              </button>
              <button className="border border-border px-6 py-3 rounded-lg font-medium">
                Browse Recipes
              </button>
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Dark Theme

<Canvas>
  <Story name="Dark Theme">
    {() => (
      <div className="dark">
        <div className="bg-background">
          <TopNav position="static" />
          <div className="p-6 bg-background">
            <div className="space-y-4">
              <h2 className="text-foreground text-xl font-semibold">Dark Theme</h2>
              <p className="text-muted-foreground">
                Navigation automatically adapts to dark theme with proper contrast and backdrop blur
              </p>
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Component Integration Demo

<Canvas>
  <Story name="Component Integration">
    {() => (
      <div className="space-y-6">
        <div className="text-sm text-muted-foreground">
          TopNav integrates multiple layout components:
        </div>

        <div className="border rounded-lg overflow-hidden">
          <TopNav position="static" />

          <div className="p-6 space-y-4">
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-xs">
              <div className="p-3 bg-muted/20 rounded">
                <div className="font-medium mb-1">GlobalNav</div>
                <div className="text-muted-foreground">Main navigation items</div>
              </div>

              <div className="p-3 bg-muted/20 rounded">
                <div className="font-medium mb-1">SearchBar</div>
                <div className="text-muted-foreground">Search functionality</div>
              </div>

              <div className="p-3 bg-muted/20 rounded">
                <div className="font-medium mb-1">ThemeToggle</div>
                <div className="text-muted-foreground">Theme switching</div>
              </div>

              <div className="p-3 bg-muted/20 rounded">
                <div className="font-medium mb-1">UserMenu</div>
                <div className="text-muted-foreground">User authentication</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Custom Styling

<Canvas>
  <Story name="Custom Style">
    {() => (
      <div className="space-y-6">
        <div className="text-sm text-muted-foreground">Custom styling examples:</div>

        <div className="space-y-4">
          <div>
            <div className="text-xs text-muted-foreground mb-2">Custom background color:</div>
            <TopNav
              className="bg-gradient-to-r from-blue-600 to-purple-600 text-white border-none"
              position="static"
            />
          </div>

          <div>
            <div className="text-xs text-muted-foreground mb-2">Custom border and shadow:</div>
            <TopNav
              className="border-2 border-primary shadow-lg"
              position="static"
            />
          </div>

          <div>
            <div className="text-xs text-muted-foreground mb-2">Increased height:</div>
            <TopNav
              className="h-20"
              position="static"
            />
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Performance Demo

<Canvas>
  <Story name="Performance">
    {() => {
      const [renderCount, setRenderCount] = React.useState(0);

      React.useEffect(() => {
        setRenderCount(prev => prev + 1);
      });

      return (
        <div className="space-y-4">
          <TopNav position="static" />
          <div className="p-6">
            <div className="text-sm text-muted-foreground">
              Render count: {renderCount} (should be minimal with proper memoization)
            </div>
          </div>
        </div>
      );
    }}
  </Story>
</Canvas>

## Interactive Example

<Canvas>
  <Story name="Interactive">
    {(args) => (
      <div className="space-y-4">
        <div className="text-sm text-muted-foreground">
          Use the controls below to configure TopNav:
        </div>
        <TopNav {...args} />
        <div className="p-6 bg-muted/20">
          <div className="text-sm text-muted-foreground">
            Sample content area
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Component API

<ArgsTable of={TopNav} />

## Layout Composition

### Desktop Layout Structure
- **Logo/Brand**: Left-aligned with home link
- **GlobalNav**: Center-left navigation items
- **SearchBar**: Center-right search functionality
- **ThemeToggle**: Right-aligned theme switching
- **UserMenu**: Far-right user controls

### Tablet Layout Structure
- **Logo/Brand**: Left-aligned
- **GlobalNav**: Condensed navigation items
- **SearchBar**: Compact search icon
- **ThemeToggle**: Theme switching
- **UserMenu**: User controls

### Mobile Layout Structure
- **Logo/Brand**: Left-aligned
- **SearchBar**: Compact search icon (optional)
- **ThemeToggle**: Theme switching
- **UserMenu**: Compact user avatar
- **MobileMenuButton**: Hamburger menu trigger

## Visual Variants

### Default Variant
- Semi-transparent background with backdrop blur
- Border bottom for separation
- Modern glassmorphism effect
- Supports all responsive features

### Minimal Variant
- Reduced visual weight
- Only essential controls (theme toggle, user menu)
- Subtle backdrop blur
- Perfect for focused content pages

### Transparent Variant
- Fully transparent background
- No borders or backdrop effects
- Overlays content seamlessly
- Ideal for landing pages and hero sections

## Position Behaviors

### Sticky Positioning
- Sticks to top when scrolling
- Maintains visibility during page navigation
- Smooth scrolling behavior
- Most common use case

### Fixed Positioning
- Always visible at top of viewport
- Does not scroll with content
- Covers content when needed
- Useful for critical navigation

### Static Positioning
- Normal document flow
- Scrolls with page content
- No special positioning behavior
- Good for demos and contained layouts

## Accessibility Features

- **Semantic HTML**: Proper `<header>` and `<nav>` elements
- **ARIA Labels**: Comprehensive labeling for screen readers
- **Keyboard Navigation**: Full keyboard support across all components
- **Focus Management**: Logical tab order and clear focus indicators
- **Screen Reader Support**: Proper landmark identification
- **High Contrast**: Works with all theme variants

## Responsive Design

### Breakpoint Behavior
- **Mobile (< 768px)**: Minimal layout with hamburger menu
- **Tablet (768px - 1024px)**: Compact layout with essential features
- **Desktop (> 1024px)**: Full layout with all features

### Component Adaptation
- **GlobalNav**: Hidden on mobile, condensed on tablet, full on desktop
- **SearchBar**: Icon-only on mobile/tablet, full input on desktop
- **UserMenu**: Compact on mobile, full on tablet/desktop
- **ThemeToggle**: Consistent across all breakpoints

## Performance Considerations

### Optimization Strategies
- Memoized component rendering
- Efficient responsive behavior
- Lazy-loaded mobile navigation drawer
- Minimal re-renders on route changes

### Bundle Impact
- Tree-shakeable component imports
- Efficient icon loading
- Minimal JavaScript for basic functionality

## Implementation Notes

- Integrates seamlessly with Next.js App Router
- Uses layout store for responsive behavior management
- Supports authentication state through auth store
- Implements proper backdrop blur for modern appearance
- Type-safe with comprehensive TypeScript interfaces
- Follows design system conventions consistently
- Optimized for performance with proper memoization patterns
- Supports internationalization patterns for future expansion
