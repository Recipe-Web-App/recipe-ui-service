import {
  Meta,
  Story,
  Canvas,
  ArgsTable,
  Description,
} from '@storybook/addon-docs';
import { BuildInfo } from './build-info';

<Meta
  title="Layout Components/BuildInfo"
  component={BuildInfo}
  parameters={{
    docs: {
      description: {
        component: `
The BuildInfo component displays build and version information for the application.
It shows version numbers, environment details, and optional git branch information with clean, accessible styling.

## Features

- Displays application version from environment variables
- Shows current environment (development, production, etc.)
- Optional git branch information
- Compact and full layout modes
- Icons for visual clarity
- Responsive design
- Full accessibility support with screen reader labels
- TypeScript support with strict typing

## Usage

Use BuildInfo for:

- Footer build information display
- Development environment indicators
- Version tracking in deployed applications
- Technical metadata for support purposes
- Debugging and development assistance
  `
  }
  }
  }}
  argTypes={{
      showVersion: {
        control: { type: 'boolean' },
        description: 'Whether to show version number',
        defaultValue: true
      },
      showEnvironment: {
        control: { type: 'boolean' },
        description: 'Whether to show environment',
        defaultValue: true
      },
      showBranch: {
        control: { type: 'boolean' },
        description: 'Whether to show git branch (if available)',
        defaultValue: false
      },
      compact: {
        control: { type: 'boolean' },
        description: 'Whether to use compact layout',
        defaultValue: false
      },
      className: {
        control: { type: 'text' },
        description: 'Additional CSS classes to apply'
      }
    }}
  />

# BuildInfo

<Description of={BuildInfo} />

## Default Display

<Canvas>
  <Story name="Default">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo />
      </div>
    )}
  </Story>
</Canvas>

## Compact Mode

<Canvas>
  <Story name="Compact">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo compact />
      </div>
    )}
  </Story>
</Canvas>

## Version Only

<Canvas>
  <Story name="Version Only">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo showEnvironment={false} />
      </div>
    )}
  </Story>
</Canvas>

## Environment Only

<Canvas>
  <Story name="Environment Only">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo showVersion={false} />
      </div>
    )}
  </Story>
</Canvas>

## With Branch Information

<Canvas>
  <Story name="With Branch">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo showBranch />
      </div>
    )}
  </Story>
</Canvas>

## Compact with All Info

<Canvas>
  <Story name="Compact All Info">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo compact showBranch />
      </div>
    )}
  </Story>
</Canvas>

## Different Contexts

<Canvas>
  <Story name="Footer Context">
    {() => (
      <div className="bg-background rounded border p-6">
        {/* Simulated footer */}
        <div className="flex flex-col space-y-4">
          <div className="text-muted-foreground text-sm">
            Â© 2024 Recipe App. All rights reserved.
          </div>
          <div className="flex items-center justify-between">
            <div className="text-muted-foreground text-xs">
              Build information:
            </div>
            <BuildInfo />
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Mobile Layout

<Canvas>
  <Story name="Mobile">
    {() => (
      <div className="bg-background max-w-xs rounded border p-4">
        <div className="space-y-3">
          <div className="text-sm">Mobile footer layout:</div>
          <BuildInfo compact />
          <div className="text-muted-foreground text-xs">
            Compact mode works better on mobile
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Custom Styling

<Canvas>
  <Story name="Custom Style">
    {() => (
      <div className="bg-background rounded border p-4">
        <BuildInfo
          className="rounded border border-blue-200 px-2 py-1 text-blue-600"
          showBranch
        />
      </div>
    )}
  </Story>
</Canvas>

## Empty State

<Canvas>
  <Story name="Empty State">
    {() => (
      <div className="bg-background rounded border p-4">
        <div className="space-y-2">
          <div className="text-sm">When all items are hidden:</div>
          <BuildInfo
            showVersion={false}
            showEnvironment={false}
            showBranch={false}
          />
          <div className="text-muted-foreground text-xs">
            Component renders nothing when no items are visible
          </div>
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Interactive Example

<Canvas>
  <Story name="Interactive">
    {args => (
      <div className="bg-background rounded border p-4">
        <div className="space-y-4">
          <div className="text-sm font-medium">
            Use the controls below to configure BuildInfo:
          </div>
          <BuildInfo {...args} />
        </div>
      </div>
    )}
  </Story>
</Canvas>

## Component API

<ArgsTable of={BuildInfo} />

## Accessibility Features

- **Screen Reader Labels**: Each piece of information includes hidden labels for context
- **Semantic Markup**: Uses appropriate ARIA labels and landmarks
- **Keyboard Navigation**: Focusable when needed for interactive use cases
- **High Contrast**: Works well with all theme variants
- **Icon Descriptions**: Icons are properly hidden from screen readers with aria-hidden

## Configuration

### Environment Variables

The component reads from these environment variables:

- `NEXT_PUBLIC_APP_VERSION` - Application version number
- `NODE_ENV` - Current environment (development, production, test)
- `NEXT_PUBLIC_GIT_BRANCH` - Git branch name (optional)

### Display Logic

- **Version**: Shows "v" prefix with version number
- **Environment**: Shows "prod" for production, otherwise shows environment name
- **Branch**: Only shows when `showBranch` is true and branch is available

## Design Guidelines

### Layout Modes

**Full Mode (default)**:

- Icons with text
- Horizontal layout with spacing
- Better for desktop footers

**Compact Mode**:

- Text only with dot separators
- Minimal space usage
- Better for mobile or tight spaces

### Styling

- Uses muted text color for subtle appearance
- Small text size appropriate for metadata
- Icons are small and subtle
- Consistent with overall design system

## Implementation Notes

- The component returns `null` when no items are configured to show
- Environment variable parsing happens at build time for Next.js
- Icons are from the Lucide React library
- All styling uses design system tokens for consistency
- The component is fully typed with TypeScript interfaces
